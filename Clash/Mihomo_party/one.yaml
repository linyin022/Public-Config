# 混合端口 HTTP和SOCKS5用一个端口
mixed-port: 7890
# TCP 并发连接所有 IP, 将使用最快握手的 TCP
tcp-concurrent: true
# 规则模式：rule/global/direct/script
mode: rule
# 设置日志输出级别: silent/error/warning/info/debug
log-level: error
# 全局 TLS 指纹
#global-client-fingerprint: chrome
# 匹配所有进程（always/strict/off）
find-process-mode: strict
# 去除握手等额外延迟
unified-delay: true
profile:
  store-selected: true
  store-fake-ip: true

#DNS
dns:
  enable: true
  prefer-h3: true
  default-nameserver:
    - 180.184.1.1
    - udp://47.108.230.123:5553
    - https://119.29.29.29/dns-query
  nameserver-policy:
    "http-inputs-notion.splunkcloud.com,+.notion-static.com,+.notion.com,+.notion.new,+.notion.site,+.notion.so": tls://dns.jerryw.cn
    geosite:geolocation-!cn:
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
      - 180.184.1.1
    nameserver:
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
      - 180.184.1.1

#sniffer
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - +.v2ex.com

rule-providers:
  private:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.yaml
    path: ./ruleset/private.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http

  cn_domain:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.yaml
    path: ./ruleset/cn_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http

  telegram_domain:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.yaml
    path: ./ruleset/telegram_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http

  geolocation-!cn:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.yaml
    path: ./ruleset/geolocation-!cn.yaml
    behavior: domain
    interval: 86400
    format: yaml
    type: http

  cn_ip:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.yaml
    path: ./ruleset/cn_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml
    type: http

  telegram_ip:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.yaml
    path: ./ruleset/telegram_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml
    type: http

  steam:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Steam/Steam.yaml
    path: ./ruleset/steam.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http

  ai:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/Repcz/Tool/X/Clash/Rules/AI.list
    path: ./ruleset/ai.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  spotify:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.yaml
    path: ./ruleset/spotify.yaml
    behavior: classical
    interval: 86400
    format: yaml
    type: http

  wechat:
    url: https://whatshub.top/rule/WeChat.list
    path: ./ruleset/wechat.list
    behavior: classical
    interval: 86400
    format: text
    type: http

  pt_domain:
    url: https://mirror.ghproxy.com/https://raw.githubusercontent.com/linyin022/Public-Config/main/Clash/Rule/PTDomain.list
    path: ./ruleset/pt_domain.list
    behavior: classical
    interval: 86400
    format: text
    type: http

proxy-groups:
  - icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Auto_Speed.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|频道|订阅|ISP|流量|到期|重置
    name: PROXY
    type: select
    filter: 🇭🇰|香港|HK|Hong|Hong Kong|🇸🇬|新加坡|狮|SG|Singapore|🇹🇼|🇨🇳|台湾|TW|Tai|Taiwan|🇯🇵|日本|JP|Japan|🇸🇬|新加坡|狮|SG|Singapore|🇺🇸|美国|US|United States
    proxies:
      - Universal

  - icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Social_Media/Telegram.png
    name: Telegram
    type: select
    include-all: true
    filter: 🇭🇰|香港|HK|Hong|Hong Kong|🇸🇬|新加坡|狮|SG|Singapore

  - icon: https://raw.githubusercontent.com/tugepaopao/Image-Storage/master/cartoon/Cute/%23.png
    name: AIGC
    type: select
    include-all: true
    filter: 🇺🇸|美国|洛杉矶|圣何塞|US|United States

  - icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Available.png
    name: Universal
    type: select
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|频道|订阅|ISP|流量|到期|重置|🇭🇰|香港|HK|Hong|Hong Kong|🇸🇬|新加坡|狮|SG|Singapore|🇹🇼|🇨🇳|台湾|TW|Tai|Taiwan|🇯🇵|日本|JP|Japan|🇸🇬|新加坡|狮|SG|Singapore|🇺🇸|美国|US|United States

  - icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Final.png
    include-all: true
    exclude-filter: (?i)GB|Traffic|Expire|Premium|频道|订阅|ISP|流量|到期|重置
    name: GLOBAL
    type: select

rules:
  - "RULE-SET,pt_domain,DIRECT"
  - "RULE-SET,wechat,DIRECT"
  - "RULE-SET,private,DIRECT"
  - "RULE-SET,spotify,DIRECT"
  - "RULE-SET,ai,AIGC"
  - "RULE-SET,steam,PROXY"
  - "RULE-SET,telegram_domain,Telegram"
  - "RULE-SET,telegram_ip,Telegram"
  - "RULE-SET,geolocation-!cn,PROXY"
  - "RULE-SET,cn_domain,DIRECT"
  - "RULE-SET,cn_ip,DIRECT"
  - "MATCH,PROXY"
